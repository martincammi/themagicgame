CREATE TABLE Card (id INT UNSIGNED AUTO_INCREMENT, namespanish TEXT NOT NULL, nameenglish TEXT NOT NULL, cost INT UNSIGNED DEFAULT '0', cardid INT UNSIGNED DEFAULT '0' NOT NULL, state TEXT, rarity VARCHAR(10) NOT NULL, stock INT UNSIGNED DEFAULT '0' NOT NULL, idexpansion INT UNSIGNED DEFAULT '0' NOT NULL, iddetails INT UNSIGNED DEFAULT '0', INDEX idexpansion_idx (idexpansion), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE Dispatch (id INT UNSIGNED, name TEXT NOT NULL, descripcion TEXT, cost INT UNSIGNED DEFAULT '0' NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE Expansion (id INT UNSIGNED AUTO_INCREMENT, name TEXT NOT NULL, abbreviation TEXT NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE Item (id INT UNSIGNED, number INT UNSIGNED DEFAULT '0' NOT NULL, idcard INT UNSIGNED DEFAULT '0' NOT NULL, idorder INT UNSIGNED DEFAULT '0' NOT NULL, INDEX idcard_idx (idcard), INDEX idorder_idx (idorder), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE Orders (id INT UNSIGNED AUTO_INCREMENT, created_at DATE NOT NULL, comment TEXT, iduser INT UNSIGNED DEFAULT '0' NOT NULL, idpaymenttype INT UNSIGNED DEFAULT '0' NOT NULL, iddispathtype INT UNSIGNED DEFAULT '0' NOT NULL, INDEX iddispathtype_idx (iddispathtype), INDEX idpaymenttype_idx (idpaymenttype), INDEX iduser_idx (iduser), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE Payment (id INT UNSIGNED, name TEXT NOT NULL, description TEXT, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE User (id INT UNSIGNED, user TEXT NOT NULL, password TEXT NOT NULL, name TEXT NOT NULL, surname TEXT NOT NULL, email TEXT NOT NULL, idaddress INT UNSIGNED DEFAULT '0', PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_forgot_password (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id BIGINT AUTO_INCREMENT, user_id BIGINT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user (id BIGINT AUTO_INCREMENT, first_name VARCHAR(255), last_name VARCHAR(255), email_address VARCHAR(255) NOT NULL UNIQUE, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id BIGINT, group_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) ENGINE = INNODB;
ALTER TABLE Card ADD CONSTRAINT Card_idexpansion_Expansion_id FOREIGN KEY (idexpansion) REFERENCES Expansion(id);
ALTER TABLE Item ADD CONSTRAINT Item_idorder_Orders_id FOREIGN KEY (idorder) REFERENCES Orders(id);
ALTER TABLE Item ADD CONSTRAINT Item_idcard_Card_id FOREIGN KEY (idcard) REFERENCES Card(id);
ALTER TABLE Orders ADD CONSTRAINT Orders_iduser_User_id FOREIGN KEY (iduser) REFERENCES User(id);
ALTER TABLE Orders ADD CONSTRAINT Orders_idpaymenttype_Payment_id FOREIGN KEY (idpaymenttype) REFERENCES Payment(id);
ALTER TABLE Orders ADD CONSTRAINT Orders_iddispathtype_Dispatch_id FOREIGN KEY (iddispathtype) REFERENCES Dispatch(id);
ALTER TABLE sf_guard_forgot_password ADD CONSTRAINT sf_guard_forgot_password_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
